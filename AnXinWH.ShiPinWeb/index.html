<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

    <title>ISEC Video</title>

    <script src="Scripts/jquery-1.11.3.min.js"></script>
    <script src="js/ISECVideo.js"></script>
    <script src="js/todo.js"></script>

</head>
<body>
    <div>
        <a href="ISECNewVideo.msi">视频控件下载</a>
        <br />
    </div>
    <hr />
    <div>
        <object id="a" classid="clsid:66F195EB-3753-45FA-93A6-6B58F33DBC85"></object>
    </div>
    <script type="text/javascript">
        $(function () {
            var a = document.getElementById("a");
            try {
                var getVersion = a.jsGetVersion();

                if (getVersion != "1.0.0.7") {
                    alert("请升级新版本控件。");
                }

                document.title = 'ISEC Video V' + getVersion;

                ////http://192.168.1.120/index.html?receiptNo=1343434&InstartTime=2015-11-02 13:20:00&InendTime=2015-11-2 14:00:30&OutstartTime=2015-11-02 13:20:00&OutendTime=2015-11-2 14:00:30&ShelfstartTime=2015-11-02 13:20:00&ShelfendTime=2015-11-2 14:00:30
                var receiptNo = GetArgsFromHref(document.location.href, "receiptNo");
                if (receiptNo) {
                    a.SetReceiptNo("仓单号:" + receiptNo.toString());
                } else {
                    a.SetReceiptNo("没有仓单号。");
                }
                var InstartTime = GetArgsFromHref(document.location.href, "InstartTime");
                var InendTime = GetArgsFromHref(document.location.href, "InendTime");
                var OutstartTime = GetArgsFromHref(document.location.href, "OutstartTime");
                var OutendTime = GetArgsFromHref(document.location.href, "OutendTime");
                var ShelfstartTime = GetArgsFromHref(document.location.href, "ShelfstartTime");
                var ShelfendTime = GetArgsFromHref(document.location.href, "ShelfendTime");

                a.jsSetTimeShelf(ShelfstartTime, ShelfendTime);
                a.jsSetTimeOut(OutstartTime, OutendTime);

                var dd = a.jsSetTimeIn(InstartTime, InendTime);

                if (dd.toString() != "ok") {

                    alert(dd);
                }

            } catch (e) {
                alert("加载控件失败。Error:" + e.message);
            }
        });
    </script>
</body>
</html>
